!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("angular")):"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?exports["sparql-service"]=t(require("angular")):e["sparql-service"]=t(e.angular)}(this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=function(){function e(){this.objectsById={},this.assignmentsById={}}return e}();t.UniqueObjectTracker=a;var i=function(){function e(e,t){this.$http=e,this.$q=t}return e.$inject=["$http","$q"],e.stringToSPARQLString=function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\f/g,"\\f")+'"'},e.bindingsToObject=function(t,r,n,a){void 0===r&&(r={});for(var i in t){var o=i,s=r,u=o.indexOf("_"),p=-1,l=void 0;for(a&&(l=a.assignmentsById);-1!==u;){o=i.substring(p+1,u);var d=i.substring(0,u);if(n&&n.bindingTypes&&n.bindingTypes[d]&&"uniqueArray"===n.bindingTypes[d]){s[o]||(s[o]=[]),a.objectsById[d]||(a.objectsById[d]={});var c=void 0;a.objectsById[d][t[d].value]?c=a.objectsById[d][t[d].value]:(c=n.bindingConverters[d](t[d],t),a.objectsById[d][t[d].value]=c),l[d]||(l[d]={}),l[d][t[d].value]||(s[d].push(c),l[d][t[d].value]={}),l=l[d][t[d].value],s=c}else n&&n.bindingTypes&&n.bindingTypes[d]&&"single"===n.bindingTypes[d]?(a.objectsById[d]||(a.objectsById[d]={}),a.objectsById[d][t[d].value]||(s[o]=n.bindingConverters[d](t[d],t),a.objectsById[d][t[d].value]=s[o])):s[o]||(s[o]=n.bindingConverters[d](t[d],t)),s=s[o];p=u,u=i.indexOf("_",u+1)}o=i.substring(p+1);var h=void 0;if(a&&n&&n.bindingTypes&&("single"===n.bindingTypes[i]||"uniqueArray"===n.bindingTypes[i])?(a.objectsById[i]||(a.objectsById[i]={}),a.objectsById[i][t[i].value]?h=a.objectsById[i][t[i].value]:(h=n&&n.bindingConverters&&n.bindingConverters[i]?n.bindingConverters[i](t[i],t):e.bindingToValue(t[i]),a.objectsById[i][t[i].value]=h)):n&&n.bindingConverters&&n.bindingConverters[i]?h=n.bindingConverters[i](t[i],t):n&&n.bindingTypes&&n.bindingTypes[i]&&("hash"===n.bindingTypes[i]||"ignore"===n.bindingTypes[i])||(h=e.bindingToValue(t[i])),n&&n.bindingTypes&&n.bindingTypes[i])switch(n.bindingTypes[i]){case"ignore":break;case"single":s[o]=h;break;case"array":Array.isArray(s[o])||(s[o]=[]),s[o].push(h);break;case"hash":if(s[o]||(s[o]={}),h)s[o][t[i].value]=h;else if("literal"===t[i].type){var g=t[i].datatype;g||(g=t[i]["xml:lang"])||(g=""),s[o][g]=t[i].value}else s[o][t[i].value]=t[i].value;break;default:s[o]||(s[o]=[]),l[i]||(l[i]={}),l[i][t[i].value]||(l[i][t[i].value]=h,s[o].push(h))}else if(Array.isArray(s[o]))s[o].push(h);else if(null!==s[o]&&"object"==typeof s[o]&&t[i])if("literal"===t[i].type){var g=t[i].datatype;g||(g=t[i]["xml:lang"])||(g=""),n&&n.bindingConverters&&n.bindingConverters[i]?s[o][g]=n.bindingConverters[i](t[i],t):s[o][g]=t[i].value}else n&&n.bindingConverters&&n.bindingConverters[i]?s[o][t[i].value]=n.bindingConverters[i](t[i],t):s[o][t[i].value]=t[i].value;else s[o]=h}return r},e.bindingToValue=function(e){if(e){if("uri"===e.type)return e.value;if("bnode"===e.type)return e.value;if(e.datatype)switch(e.datatype){case"http://www.w3.org/2001/XMLSchema#integer":case"http://www.w3.org/2001/XMLSchema#decimal":return parseInt(e.value,10);case"http://www.w3.org/2001/XMLSchema#float":case"http://www.w3.org/2001/XMLSchema#double":return parseFloat(e.value);case"http://www.w3.org/2001/XMLSchema#boolean":return!!e.value}return e.value}},e.bindingToString=function(e){if(!e)return"UNDEF";var t=e.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\"/g,'\\"').replace(/\'/g,"\\'");if("uri"===e.type)return"<"+t+">";if("bnode"===e.type)return"_:"+t;if(!e.datatype)return e["xml:lang"]?'"'+t+'"@'+e["xml:lang"]:'"'+t+'"';switch(e.datatype){case"http://www.w3.org/2001/XMLSchema#integer":case"http://www.w3.org/2001/XMLSchema#decimal":case"http://www.w3.org/2001/XMLSchema#double":case"http://www.w3.org/2001/XMLSchema#boolean":return t;case"http://www.w3.org/2001/XMLSchema#string":return'"'+t+'"';default:return'"'+t+'"^^<'+e.datatype+">"}},e.prototype.check=function(e,t){var r=this.$q.defer();return this.$http(n.extend({method:"GET",url:e,params:{query:"ASK {}"},headers:{Accept:"application/sparql-results+json"}},t)).then(function(e){return r.resolve(!0===e.data.boolean)},function(e){return r.resolve(!1)}),r.promise},e.prototype.checkUpdate=function(e,t){var r=this.$q.defer();return this.$http(n.extend({method:"POST",url:e,headers:{"Content-Type":"application/sparql-update"},data:"INSERT DATA {}"},t)).then(function(e){return r.resolve(204===e.status)},function(e){return r.resolve(!1)}),r.promise},e.prototype.checkRest=function(e,t){var r=this.$q.defer();return this.$http(n.extend({method:"POST",url:e+"?default",data:"",headers:{"Content-Type":"text/turtle"}},t)).then(function(e){return r.resolve(204===e.status)},function(e){return r.resolve(!1)}),r.promise},e.prototype.get=function(e,t,r){return this.$http(n.extend({method:"GET",url:e,params:t?{graph:t}:{default:""},headers:{Accept:"text/turtle"}},r))},e.prototype.post=function(e,t,r,a){return this.$http(n.extend({method:"POST",url:e,params:r?{graph:r}:{default:""},data:t,headers:{"Content-Type":"text/turtle"}},a))},e.prototype.put=function(e,t,r,a){return this.$http(n.extend({method:"PUT",url:e,params:r?{graph:r}:{default:""},data:t,headers:{"Content-Type":"text/turtle"}},a))},e.prototype.delete=function(e,t,r){return this.$http(n.extend({method:"DELETE",url:e,params:t?{graph:t}:{default:""}},r))},e.prototype.query=function(e,t,r){return t.length<=2048?this.$http(n.extend({method:"GET",url:e,params:{query:t},headers:{Accept:"application/sparql-results+json"}},r)):this.$http(n.extend({method:"POST",url:e,data:"query="+encodeURIComponent(t),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/sparql-results+json"}},r))},e.prototype.construct=function(e,t,r){return t.length<=2048?this.$http(n.extend({method:"GET",url:e,params:{query:t},headers:{Accept:"text/turtle"}},r)):this.$http(n.extend({method:"POST",url:e,data:t,headers:{"Content-Type":"application/sparql-query",Accept:"text/turtle"}},r))},e.prototype.update=function(e,t,r){return this.$http(n.extend({method:"POST",url:e,headers:{"Content-Type":"application/sparql-update"},data:t},r))},e}();t.SparqlService=i,n.module("fi.seco.sparql",[]).service("sparqlService",i)}])});