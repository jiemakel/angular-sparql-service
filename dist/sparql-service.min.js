!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("angular")):"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?exports["sparql-service"]=t(require("angular")):e["sparql-service"]=t(e.angular)}(this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=function(){function e(){this.objectsById={},this.assignmentsById={}}return e}();t.UniqueObjectTracker=a;var i=function(){function e(e,t){this.$http=e,this.$q=t}return e.$inject=["$http","$q"],e.stringToSPARQLString=function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\f/g,"\\f")+'"'},e.bindingsToObject=function(t,r,n,a,i){void 0===r&&(r={});for(var o in t){var s=o,u=r,p=s.indexOf("_"),l=-1,d=void 0;for(i&&(i.assignmentsById[a]||(i.assignmentsById[a]={}),d=i.assignmentsById[a]);-1!==p;){s=o.substring(l+1,p);var c=o.substring(0,p);if(n&&n.bindingTypes&&n.bindingTypes[c]&&"uniqueArray"===n.bindingTypes[c]){u[s]||(u[s]=[]),i.objectsById[c]||(i.objectsById[c]={});var h=void 0;i.objectsById[c][t[c].value]?h=i.objectsById[c][t[c].value]:(h=n.bindingConverters[c](t[c],t),i.objectsById[c][t[c].value]=h),d[c]||(d[c]={}),d[c][t[c].value]||(u[c].push(h),d[c][t[c].value]={}),d=d[c][t[c].value],u=h}else n&&n.bindingTypes&&n.bindingTypes[c]&&"single"===n.bindingTypes[c]?(i.objectsById[c]||(i.objectsById[c]={}),i.objectsById[c][t[c].value]||(u[s]=n.bindingConverters[c](t[c],t),i.objectsById[c][t[c].value]=u[s])):u[s]||(u[s]=n.bindingConverters[c](t[c],t)),u=u[s];l=p,p=o.indexOf("_",p+1)}s=o.substring(l+1);var g=void 0;if(i&&n&&n.bindingTypes&&("single"===n.bindingTypes[o]||"uniqueArray"===n.bindingTypes[o])?(i.objectsById[o]||(i.objectsById[o]={}),i.objectsById[o][t[o].value]?g=i.objectsById[o][t[o].value]:(g=n&&n.bindingConverters&&n.bindingConverters[o]?n.bindingConverters[o](t[o],t):e.bindingToValue(t[o]),i.objectsById[o][t[o].value]=g)):n&&n.bindingConverters&&n.bindingConverters[o]?g=n.bindingConverters[o](t[o],t):n&&n.bindingTypes&&n.bindingTypes[o]&&("hash"===n.bindingTypes[o]||"ignore"===n.bindingTypes[o])||(g=e.bindingToValue(t[o])),n&&n.bindingTypes&&n.bindingTypes[o])switch(n.bindingTypes[o]){case"ignore":break;case"single":u[s]=g;break;case"array":Array.isArray(u[s])||(u[s]=[]),u[s].push(g);break;case"hash":if(u[s]||(u[s]={}),g)u[s][t[o].value]=g;else if("literal"===t[o].type){var y=t[o].datatype;y||(y=t[o]["xml:lang"])||(y=""),u[s][y]=t[o].value}else u[s][t[o].value]=t[o].value;break;default:u[s]||(u[s]=[]),d[o]||(d[o]={}),d[o][t[o].value]||(d[o][t[o].value]=g,u[s].push(g))}else if(Array.isArray(u[s]))u[s].push(g);else if(null!==u[s]&&"object"==typeof u[s]&&t[o])if("literal"===t[o].type){var y=t[o].datatype;y||(y=t[o]["xml:lang"])||(y=""),n&&n.bindingConverters&&n.bindingConverters[o]?u[s][y]=n.bindingConverters[o](t[o],t):u[s][y]=t[o].value}else n&&n.bindingConverters&&n.bindingConverters[o]?u[s][t[o].value]=n.bindingConverters[o](t[o],t):u[s][t[o].value]=t[o].value;else u[s]=g}return r},e.bindingToValue=function(e){if(e){if("uri"===e.type)return e.value;if("bnode"===e.type)return e.value;if(e.datatype)switch(e.datatype){case"http://www.w3.org/2001/XMLSchema#integer":case"http://www.w3.org/2001/XMLSchema#decimal":return parseInt(e.value,10);case"http://www.w3.org/2001/XMLSchema#float":case"http://www.w3.org/2001/XMLSchema#double":return parseFloat(e.value);case"http://www.w3.org/2001/XMLSchema#boolean":return!!e.value}return e.value}},e.bindingToString=function(e){if(!e)return"UNDEF";var t=e.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\"/g,'\\"').replace(/\'/g,"\\'");if("uri"===e.type)return"<"+t+">";if("bnode"===e.type)return"_:"+t;if(!e.datatype)return e["xml:lang"]?'"'+t+'"@'+e["xml:lang"]:'"'+t+'"';switch(e.datatype){case"http://www.w3.org/2001/XMLSchema#integer":case"http://www.w3.org/2001/XMLSchema#decimal":case"http://www.w3.org/2001/XMLSchema#double":case"http://www.w3.org/2001/XMLSchema#boolean":return t;case"http://www.w3.org/2001/XMLSchema#string":return'"'+t+'"';default:return'"'+t+'"^^<'+e.datatype+">"}},e.prototype.check=function(e,t){var r=this.$q.defer();return this.$http(n.extend({method:"GET",url:e,params:{query:"ASK {}"},headers:{Accept:"application/sparql-results+json"}},t)).then(function(e){return r.resolve(!0===e.data.boolean)},function(e){return r.resolve(!1)}),r.promise},e.prototype.checkUpdate=function(e,t){var r=this.$q.defer();return this.$http(n.extend({method:"POST",url:e,headers:{"Content-Type":"application/sparql-update"},data:"INSERT DATA {}"},t)).then(function(e){return r.resolve(204===e.status)},function(e){return r.resolve(!1)}),r.promise},e.prototype.checkRest=function(e,t){var r=this.$q.defer();return this.$http(n.extend({method:"POST",url:e+"?default",data:"",headers:{"Content-Type":"text/turtle"}},t)).then(function(e){return r.resolve(204===e.status)},function(e){return r.resolve(!1)}),r.promise},e.prototype.get=function(e,t,r){return this.$http(n.extend({method:"GET",url:e,params:t?{graph:t}:{default:""},headers:{Accept:"text/turtle"}},r))},e.prototype.post=function(e,t,r,a){return this.$http(n.extend({method:"POST",url:e,params:r?{graph:r}:{default:""},data:t,headers:{"Content-Type":"text/turtle"}},a))},e.prototype.put=function(e,t,r,a){return this.$http(n.extend({method:"PUT",url:e,params:r?{graph:r}:{default:""},data:t,headers:{"Content-Type":"text/turtle"}},a))},e.prototype.delete=function(e,t,r){return this.$http(n.extend({method:"DELETE",url:e,params:t?{graph:t}:{default:""}},r))},e.prototype.query=function(e,t,r){return t.length<=2048?this.$http(n.extend({method:"GET",url:e,params:{query:t},headers:{Accept:"application/sparql-results+json"}},r)):this.$http(n.extend({method:"POST",url:e,data:"query="+encodeURIComponent(t),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/sparql-results+json"}},r))},e.prototype.construct=function(e,t,r){return t.length<=2048?this.$http(n.extend({method:"GET",url:e,params:{query:t},headers:{Accept:"text/turtle"}},r)):this.$http(n.extend({method:"POST",url:e,data:t,headers:{"Content-Type":"application/sparql-query",Accept:"text/turtle"}},r))},e.prototype.update=function(e,t,r){return this.$http(n.extend({method:"POST",url:e,headers:{"Content-Type":"application/sparql-update"},data:t},r))},e}();t.SparqlService=i,n.module("fi.seco.sparql",[]).service("sparqlService",i)}])});